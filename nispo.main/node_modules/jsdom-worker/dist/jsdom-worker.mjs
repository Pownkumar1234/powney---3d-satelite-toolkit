import e,{Response as t}from"node-fetch";function n(e){return{all:e=e||new Map,on:function(t,n){var o=e.get(t);o?o.push(n):e.set(t,[n])},off:function(t,n){var o=e.get(t);o&&(n?o.splice(o.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var o=e.get(t);o&&o.slice().map(function(e){e(n)}),(o=e.get("*"))&&o.slice().map(function(e){e(t,n)})}}}var o,s,r=(o=function(e,t){t=e.exports=function(){for(var e,n="",o=0;o<32;o++)e=16*t.random()|0,o>4&&o<21&&!(o%4)&&(n+="-"),n+=(12===o?4:16===o?3&e|8:e).toString(16);return n};var n=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/;t.isUUID=function(e){return n.test(e)},t.random=function(){return Math.random()}},o(s={exports:{}},s.exports),s.exports);const a="object"==typeof global?global:"object"==typeof globalThis?globalThis:void 0;a.URL||(a.URL={});let i=a.URL.$$objects;if(i||(i=new Map,a.URL.$$objects=i,a.URL.createObjectURL=e=>{let t=r();return i[t]=e,`blob:http://localhost/${t}`}),!a.fetch||!("jsdomWorker"in a.fetch)){let n=a.fetch||e;a.fetch=function(e,o){let s="object"==typeof e?e.url||e.href:e;return s.match(/^blob:/)?new Promise((e,n)=>{let o=new FileReader;o.onload=()=>{e(new(a.Response||t)(o.result,{status:200,statusText:"OK"}))},o.onerror=()=>{n(o.error)};let r=s.match(/[^/]+$/)[0];o.readAsText(i[r])}):n.call(this,e,o)},Object.defineProperty(a.fetch,"jsdomWorker",{configurable:!0,value:!0})}function l(e){this.type=e}a.document||(a.document={}),l.prototype.initEvent=Object,a.document.createEvent||(a.document.createEvent=function(e){return new(global[e]||l)(e)}),a.Worker=function(e,t){let o,s=[],r=n(),i=n(),l=!1,c={onmessage:null,dispatchEvent:r.emit,addEventListener:r.on,removeEventListener:r.off,postMessage(e){i.emit("message",{data:e})},fetch:a.fetch,importScripts(){}};r.on("message",e=>{if(l)return;let t=c.onmessage||o("onmessage");t&&t.call(c,e)}),this.addEventListener=i.on,this.removeEventListener=i.off,this.dispatchEvent=i.emit,i.on("message",e=>{this.onmessage&&this.onmessage(e)}),this.onmessage=null,this.postMessage=e=>{l||(null!=s?s.push(e):r.emit("message",{data:e}))},this.terminate=()=>{console.warn("Worker.prototype.terminate() not supported in jsdom-worker."),l=!0,s=null},a.fetch(e).then(e=>e.text()).then(e=>{let t="var self=this,global=self";for(let e in c)t+=`,${e}=self.${e}`;o=Function(t+";\n"+e+'\nreturn function(n){return n=="onmessage"?onmessage:null;}').call(c);let n=s;s=null,n&&n.forEach(this.postMessage)}).catch(e=>{i.emit("error",e),console.error(e)})};
//# sourceMappingURL=jsdom-worker.mjs.map
