!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("node-fetch")):"function"==typeof define&&define.amd?define(["node-fetch"],t):t((e||self).nodeFetch)}(this,function(e){function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=/*#__PURE__*/t(e);function o(e){return{all:e=e||new Map,on:function(t,n){var o=e.get(t);o?o.push(n):e.set(t,[n])},off:function(t,n){var o=e.get(t);o&&(n?o.splice(o.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var o=e.get(t);o&&o.slice().map(function(e){e(n)}),(o=e.get("*"))&&o.slice().map(function(e){e(t,n)})}}}var s=function(e){var t={exports:{}};return function(e,t){t=e.exports=function(){for(var e,n="",o=0;o<32;o++)e=16*t.random()|0,o>4&&o<21&&!(o%4)&&(n+="-"),n+=(12===o?4:16===o?3&e|8:e).toString(16);return n};var n=/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/;t.isUUID=function(e){return n.test(e)},t.random=function(){return Math.random()}}(t,t.exports),t.exports}();const r="object"==typeof global?global:"object"==typeof globalThis?globalThis:void 0;r.URL||(r.URL={});let a=r.URL.$$objects;if(a||(a=new Map,r.URL.$$objects=a,r.URL.createObjectURL=e=>{let t=s();return a[t]=e,`blob:http://localhost/${t}`}),!r.fetch||!("jsdomWorker"in r.fetch)){let t=r.fetch||n.default;r.fetch=function(n,o){let s="object"==typeof n?n.url||n.href:n;return s.match(/^blob:/)?new Promise((t,n)=>{let o=new FileReader;o.onload=()=>{t(new(r.Response||e.Response)(o.result,{status:200,statusText:"OK"}))},o.onerror=()=>{n(o.error)};let i=s.match(/[^/]+$/)[0];o.readAsText(a[i])}):t.call(this,n,o)},Object.defineProperty(r.fetch,"jsdomWorker",{configurable:!0,value:!0})}function i(e){this.type=e}r.document||(r.document={}),i.prototype.initEvent=Object,r.document.createEvent||(r.document.createEvent=function(e){return new(global[e]||i)(e)}),r.Worker=function(e,t){let n,s=[],a=o(),i=o(),f=!1,l={onmessage:null,dispatchEvent:a.emit,addEventListener:a.on,removeEventListener:a.off,postMessage(e){i.emit("message",{data:e})},fetch:r.fetch,importScripts(){}};a.on("message",e=>{if(f)return;let t=l.onmessage||n("onmessage");t&&t.call(l,e)}),this.addEventListener=i.on,this.removeEventListener=i.off,this.dispatchEvent=i.emit,i.on("message",e=>{this.onmessage&&this.onmessage(e)}),this.onmessage=null,this.postMessage=e=>{f||(null!=s?s.push(e):a.emit("message",{data:e}))},this.terminate=()=>{console.warn("Worker.prototype.terminate() not supported in jsdom-worker."),f=!0,s=null},r.fetch(e).then(e=>e.text()).then(e=>{let t="var self=this,global=self";for(let e in l)t+=`,${e}=self.${e}`;n=Function(t+";\n"+e+'\nreturn function(n){return n=="onmessage"?onmessage:null;}').call(l);let o=s;s=null,o&&o.forEach(this.postMessage)}).catch(e=>{i.emit("error",e),console.error(e)})}});
//# sourceMappingURL=jsdom-worker.umd.js.map
